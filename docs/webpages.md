# Geogram Web Pages

This document describes the static HTML web pages generated by Geogram applications, including URL structure, template customization, and CSS styling.

## Overview

Geogram generates static HTML files for various collection types. These files are placed in the collection folders and can be served via any web server (such as nginx or Apache) on port 80.

### How It Works

1. **Collections** are created with specific types (www, blog, chat, etc.)
2. **Templates** are stored in `{working_folder}/themes/{theme_name}/`
3. **HTML files** are generated using templates with placeholder substitution
4. **CSS** is injected inline from global and app-specific stylesheets
5. **JavaScript data** is provided via `window.GEOGRAM_DATA` for client-side rendering

## URL Structure

When served via a web server, URLs map to collection folders:

```
/{callsign}/{collection_name}/index.html    # Collection homepage
/{callsign}/{collection_name}/...           # Collection content
/{callsign}/blog/{year}/{post-slug}.html    # Blog posts
```

## Applications & Content Types

| Type | Description | Generated Files | Template |
|------|-------------|-----------------|----------|
| `home` | Main landing page | Aggregated `index.html` | `home/index.html` |
| `www` | User websites | Custom `index.html` (user-editable) | `www/index.html` |
| `files` | File browser | `index.html`, `tree.json`, `data.js` | `files/index.html` |
| `blog` | Blog posts | Post HTML files, listing page | `blog/index.html` |
| `chat` | Chat rooms | Room listing and messages | `chat/index.html` |
| `forum` | Discussions | Thread listings | `forum/index.html` |
| `events` | Event listings | Event list with calendar | `events/index.html` |
| `alerts` | Incident reports | Alert listings with filters | `alerts/index.html` |

## Template System

### Location

Templates are stored in the working folder:

```
{working_folder}/
└── themes/
    ├── default/              # Default theme (bundled)
    │   ├── styles.css        # Global CSS
    │   ├── home/
    │   │   ├── index.html    # Homepage template (aggregates all apps)
    │   │   └── styles.css    # Homepage-specific CSS
    │   ├── blog/
    │   │   ├── index.html    # Blog template
    │   │   └── styles.css    # Blog-specific CSS
    │   ├── chat/
    │   │   ├── index.html
    │   │   └── styles.css
    │   ├── events/
    │   │   ├── index.html
    │   │   └── styles.css
    │   ├── alerts/
    │   │   ├── index.html
    │   │   └── styles.css
    │   ├── forum/
    │   │   ├── index.html
    │   │   └── styles.css
    │   ├── files/
    │   │   ├── index.html
    │   │   └── styles.css
    │   └── www/
    │       ├── index.html
    │       └── styles.css
    └── custom/               # User custom themes
        └── ...
```

### Template Placeholders

Templates use double-brace syntax for variable substitution:

| Placeholder | Description |
|-------------|-------------|
| `{{TITLE}}` | Page title |
| `{{GLOBAL_STYLES}}` | Contents of `themes/{theme}/styles.css` |
| `{{APP_STYLES}}` | Contents of `themes/{theme}/{app}/styles.css` |
| `{{COLLECTION_NAME}}` | Collection or user display name |
| `{{COLLECTION_DESCRIPTION}}` | Collection description text |
| `{{CONTENT}}` | Main HTML content for the page |
| `{{GENERATED_DATE}}` | Timestamp when page was generated |
| `{{DATA_JSON}}` | JSON data object for JavaScript |
| `{{SCRIPTS}}` | Additional JavaScript code |

#### Homepage-Specific Placeholders

| Placeholder | Description |
|-------------|-------------|
| `{{RECENT_POSTS}}` | HTML for recent blog post cards |
| `{{UPCOMING_EVENTS}}` | HTML for upcoming events list |
| `{{PLACES_COUNT}}` | Number of public places |
| `{{FEATURED_PLACES}}` | HTML for featured places (optional) |
| `{{CHAT_ROOMS}}` | HTML for public chat room links |

### Example Template

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{TITLE}}</title>
  <style>{{GLOBAL_STYLES}}</style>
  <style>{{APP_STYLES}}</style>
</head>
<body>
  <header class="header">
    <div class="container">
      <h1>{{COLLECTION_NAME}}</h1>
      <p>{{COLLECTION_DESCRIPTION}}</p>
    </div>
  </header>

  <main class="main">
    <div class="container">
      {{CONTENT}}
    </div>
  </main>

  <footer class="footer">
    <div class="container">
      <p>Generated on {{GENERATED_DATE}}</p>
    </div>
  </footer>

  <script>
    window.GEOGRAM_DATA = {{DATA_JSON}};
    {{SCRIPTS}}
  </script>
</body>
</html>
```

## Creating Custom Themes

### Steps

1. Copy the default theme to a new folder:
   ```
   {working_folder}/themes/mytheme/
   ```

2. Edit `styles.css` for global style changes

3. Edit app-specific templates and styles as needed

4. Set the theme in app settings

### Theme Structure

A complete theme should include:

```
mytheme/
├── styles.css          # Required: Global styles
├── blog/
│   ├── index.html      # Blog listing template
│   └── styles.css      # Blog-specific styles
├── chat/
│   ├── index.html
│   └── styles.css
├── events/
│   ├── index.html
│   └── styles.css
├── alerts/
│   ├── index.html
│   └── styles.css
├── forum/
│   ├── index.html
│   └── styles.css
├── files/
│   ├── index.html
│   └── styles.css
└── www/
    ├── index.html
    └── styles.css
```

## CSS Variables Reference

The default theme uses CSS custom properties for easy customization. Override these in your custom theme.

### Colors (Light Mode)

| Variable | Default | Description |
|----------|---------|-------------|
| `--color-bg` | `#ffffff` | Page background |
| `--color-bg-secondary` | `#f5f5f7` | Secondary background |
| `--color-bg-tertiary` | `#e8e8ed` | Tertiary background |
| `--color-text` | `#1d1d1f` | Primary text |
| `--color-text-secondary` | `#6e6e73` | Secondary text |
| `--color-text-muted` | `#98989d` | Muted text |
| `--color-border` | `#d2d2d7` | Border color |
| `--color-border-light` | `#e8e8ed` | Light border |
| `--color-accent` | `#0066cc` | Accent/primary color |
| `--color-accent-hover` | `#0055aa` | Accent hover state |
| `--color-success` | `#34c759` | Success state |
| `--color-warning` | `#ff9500` | Warning state |
| `--color-error` | `#ff3b30` | Error state |
| `--color-link` | `#0066cc` | Link color |
| `--color-link-hover` | `#0055aa` | Link hover |

### Colors (Dark Mode)

Dark mode is automatic via `@media (prefers-color-scheme: dark)`:

| Variable | Dark Value |
|----------|------------|
| `--color-bg` | `#1c1c1e` |
| `--color-bg-secondary` | `#2c2c2e` |
| `--color-bg-tertiary` | `#3a3a3c` |
| `--color-text` | `#f5f5f7` |
| `--color-text-secondary` | `#a1a1a6` |
| `--color-text-muted` | `#6e6e73` |
| `--color-border` | `#48484a` |
| `--color-border-light` | `#3a3a3c` |
| `--color-accent` | `#0a84ff` |
| `--color-accent-hover` | `#409cff` |
| `--color-link` | `#0a84ff` |
| `--color-link-hover` | `#409cff` |

### Typography

| Variable | Default | Description |
|----------|---------|-------------|
| `--font-family` | System fonts | Primary font stack |
| `--font-family-mono` | Monospace fonts | Code font stack |
| `--font-size-xs` | `0.75rem` | Extra small (12px) |
| `--font-size-sm` | `0.875rem` | Small (14px) |
| `--font-size-base` | `1rem` | Base (16px) |
| `--font-size-lg` | `1.125rem` | Large (18px) |
| `--font-size-xl` | `1.25rem` | Extra large (20px) |
| `--font-size-2xl` | `1.5rem` | 2x large (24px) |
| `--font-size-3xl` | `2rem` | 3x large (32px) |
| `--line-height` | `1.5` | Default line height |
| `--line-height-tight` | `1.25` | Tight line height |

### Spacing

| Variable | Default | Description |
|----------|---------|-------------|
| `--spacing-xs` | `0.25rem` | 4px |
| `--spacing-sm` | `0.5rem` | 8px |
| `--spacing-md` | `1rem` | 16px |
| `--spacing-lg` | `1.5rem` | 24px |
| `--spacing-xl` | `2rem` | 32px |
| `--spacing-2xl` | `3rem` | 48px |

### Layout

| Variable | Default | Description |
|----------|---------|-------------|
| `--max-width` | `1200px` | Max container width |
| `--max-width-content` | `800px` | Narrow content width |
| `--border-radius` | `8px` | Default border radius |
| `--border-radius-sm` | `4px` | Small border radius |
| `--border-radius-lg` | `12px` | Large border radius |

### Shadows

| Variable | Light Mode | Dark Mode |
|----------|------------|-----------|
| `--shadow-sm` | `0 1px 2px rgba(0,0,0,0.05)` | `0 1px 2px rgba(0,0,0,0.3)` |
| `--shadow-md` | `0 4px 6px rgba(0,0,0,0.07)` | `0 4px 6px rgba(0,0,0,0.4)` |
| `--shadow-lg` | `0 10px 15px rgba(0,0,0,0.1)` | `0 10px 15px rgba(0,0,0,0.5)` |

### Transitions

| Variable | Default | Description |
|----------|---------|-------------|
| `--transition-fast` | `150ms ease` | Fast animations |
| `--transition-normal` | `250ms ease` | Normal animations |

## JavaScript Data Injection

Each page receives data via `window.GEOGRAM_DATA`. The structure varies by app type:

### Blog
```javascript
window.GEOGRAM_DATA = {
  posts: [
    {
      title: "Post Title",
      slug: "post-slug",
      date: "2024-01-15",
      author: "Author Name",
      excerpt: "Post excerpt...",
      tags: ["tag1", "tag2"]
    }
  ],
  collection: {
    name: "Collection Name",
    description: "Description"
  }
};
```

### Files
```javascript
window.GEOGRAM_DATA = {
  files: [
    {
      name: "filename.txt",
      type: "file",  // or "directory"
      size: 1234,
      modified: "2024-01-15T10:30:00Z"
    }
  ]
};
```

### Events
```javascript
window.GEOGRAM_DATA = {
  events: [
    {
      id: "event-id",
      title: "Event Title",
      date: "2024-01-20",
      time: "14:00",
      location: "Location",
      description: "Event description"
    }
  ]
};
```

## CSS Utility Classes

The default theme includes utility classes:

### Text
- `.text-center`, `.text-right` - Text alignment
- `.text-muted` - Muted color
- `.text-sm`, `.text-xs` - Small text sizes

### Flexbox
- `.flex`, `.flex-col` - Display flex
- `.items-center`, `.justify-between` - Alignment
- `.gap-sm`, `.gap-md` - Gap spacing

### Spacing
- `.mt-sm`, `.mt-md`, `.mt-lg` - Margin top
- `.mb-sm`, `.mb-md`, `.mb-lg` - Margin bottom

### Grid
- `.grid` - Grid container
- `.grid-2`, `.grid-3`, `.grid-4` - Column counts

## Source Files

- `lib/services/web_theme_service.dart` - Theme extraction and management
- `lib/services/collection_service.dart` - Collection creation and HTML generation
- `lib/services/blog_service.dart` - Blog post handling
- `themes/default/` - Default theme templates and styles
